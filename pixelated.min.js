(()=>{let t={width:12,height:13},e=["#0000ff","#ff0000","#008000","#ffff00","#ffa500","#800080"],n=[],l=22,o=0,d=document.getElementById("board"),i=document.getElementById("controls"),r=document.getElementById("status"),E=document.getElementById("winning-streak"),s=document.getElementById("new-button"),a=document.getElementById("help-button"),c=document.getElementById("help-container"),$=document.getElementById("help-title"),g=document.getElementById("help-description"),h=document.getElementById("help-objective"),m=document.getElementById("help-instructions"),I=document.getElementById("help-controls"),L=document.getElementById("back-button"),f=document.getElementById("copyright"),y=()=>{n=B(),T(),C(),O()},B=()=>Array.from({length:t.height},()=>Array.from({length:t.width},()=>e[Math.floor(Math.random()*e.length)])),T=()=>{d.style.gridTemplateColumns=`repeat(${t.width}, 1fr)`,d.innerHTML=n.flatMap((t,e)=>t.map((t,e)=>`<div class="cell" style="background-color:${t}"></div>`)).join("")},C=()=>{i.innerHTML=e.map(t=>`<button class="color-button" style="background-color:${t}" data-color="${t}"></button>`).join(""),Array.from(i.children).forEach(t=>t.addEventListener("click",()=>p(t.dataset.color))),a.addEventListener("click",()=>S(!0)),L.addEventListener("click",()=>S(!1)),s.textContent=TEXTS.NEW_BUTTON,$.textContent=TEXTS.HELP_TITLE,g.textContent=TEXTS.HELP_DESCRIPTION,h.textContent=TEXTS.HELP_OBJECTIVE,m.textContent=TEXTS.HELP_INSTRUCTIONS,I.textContent=TEXTS.HELP_CONTROLS,L.textContent=TEXTS.BACK_BUTTON,f.innerHTML=TEXTS.COPYRIGHT},S=t=>{c.classList.toggle("hidden",!t),c.classList.toggle("visible",t)},p=e=>{let o=n[0][0];if(e===o||l<=0)return;let d=(l,i)=>{l<0||i<0||l>=t.width||i>=t.height||n[i][l]!==o||(n[i][l]=e,d(l+1,i),d(l-1,i),d(l,i+1),d(l,i-1))};d(0,0),l--,T(),v(),u()?b():l<=0&&x(TEXTS.LOSS_MESSAGE)},u=()=>n.every(t=>t.every(t=>t===n[0][0])),v=()=>{r.textContent=TEXTS.MOVES_LEFT(l)},b=()=>{o++,E.classList.remove("hidden"),E.textContent=`${TEXTS.WINNING_STREAK} ${o}`,N(),x(TEXTS.WIN_MESSAGE(l))},x=t=>{r.textContent=t,N(),t===TEXTS.LOSS_MESSAGE?o=0:E.classList.remove("hidden")},N=()=>{Array.from(i.children).forEach(t=>t.disabled=!0)},O=()=>{l=22,v(),E.classList.add("hidden")};s.addEventListener("click",y),d.addEventListener("contextmenu",t=>t.preventDefault()),y()})();